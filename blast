from __future__ import division
import sys

PATH = '/Users/jon6/ncbi-blast-2.2.29+/results.out'

def process_data(path):
    with open(path) as input_file:
        for line in input_file:
            chunk = line.strip().split()
            yield chunk
x = 0
total = 0
oneHundredPercentANI = False
for piece in process_data(PATH):
    if piece[2] == '100.00' and piece[6] == '1':
        oneHundredPercentANI = True
        percent_identity = float(piece[2])
        total += percent_identity
        x += 1
        break

if not oneHundredPercentANI:
    for piece in process_data(PATH):
        percent_identity = float(piece[2])
        total += percent_identity
        x += 1

ANI = total / x
print ANI
'''
old algorithm, doesnt work correctly
total = 0
for piece in process_data(PATH):
    if piece[2] == '100.00' and piece[6] == '1':
        percent_identity = (float(piece[2])/100) * int(piece[3])
        total += percent_identity
        break
    else:
        percent_identity = (float(piece[2])/100) * int(piece[3])
        total += percent_identity

query_length = int(piece[12])
ANI = (total / query_length) * 100
print ANI

query_length = int(piece[12])
database_length = int(piece[13])
genome_length = (query_length + database_length) / 2
ANI = (total / query_length) * 100
print ANI
'''
