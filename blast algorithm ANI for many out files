from __future__ import division
import sys

path = '/Users/jon6/Desktop/blast_stuff/ecol_shig.out'

def process_data(path):
    with open(path) as input_file:
        for line in input_file:
            chunk = line.strip().split()
            yield chunk
def calculateANI(path):
    x = 0
    total = 0
    oneHundredPercentANI = False
    for piece in process_data(path):
        if piece[2] == '100.00' and piece[6] == '1':
            oneHundredPercentANI = True
            percent_identity = float(piece[2])
            decimal_percent_identity = (percent_identity/100)
            align = decimal_percent_identity*int(piece[3])
            gap_mismatch = int(piece[4]) + int(piece[5])
            total += align
            #print (total)
            x += 1
            break

    if not oneHundredPercentANI:
        for piece in process_data(path):
            percent_identity = float(piece[2])
            decimal_percent_identity = (percent_identity/100)
            align = decimal_percent_identity*int(piece[3])
            gap_mismatch = int(piece[4]) + int(piece[5])
            total += align
            #print (total)
            x += 1
            
    length = (int(piece[13]) + int(piece[12]))/2
    ANI = total /length
    return round(ANI*100, 4)

print (calculateANI(path))

'''
blastBaseDirectory = '/Users/jon6/ncbi-blast-2.2.29+/'
outFilesNamesDirectory = '/Users/jon6/ncbi-blast-2.2.29+/'
ext = ".out"

listOfFiles = []
for root, subdir, files in os.walk(deltaFilesNamesDirectory, topdown=True):
    for file in files:
        currentDirectory = subdir
        if file.endswith(ext):
            currentFile = ((os.path.join(root, file)))
            listOfFiles.append(currentFile)
listOfFilesNoRepeats = list(OrderedDict.fromkeys(listOfFiles))

n =  len(listOfFilesNoRepeats)
print listOfFilesNoRepeats

for i in range(0,n):
    s = calculateANI(listOfFilesNoRepeats[i])
    if s:
        print (str(os.path.basename(listOfFilesNoRepeats[i])) + ": " +str(s) + "%")
'''
